åœ¨ä½ çš„é¡¹ç›®ä¸­ï¼Œ**ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼ˆObject1, Object2, Object3ï¼‰**é€šè¿‡ä»£ç ä¸²è”åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„é£Ÿæè¯†åˆ«ã€é£Ÿè°±æ¨èã€å’Œè¥å…»åˆ†æçš„åº”ç”¨ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œä½ é€šè¿‡å¤šç§æŠ€æœ¯å’Œæ¨¡å—çš„ç»„åˆï¼Œä½¿å¾—å›¾åƒè¯†åˆ«ã€é£Ÿè°±ç”Ÿæˆå’Œè¥å…»åˆ†ææ— ç¼è¡”æ¥ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä¸²è”è¿™ä¸‰ä¸ªéƒ¨åˆ†çš„è¯¦ç»†æ­¥éª¤ï¼š

### 1. é£Ÿæè¯†åˆ«ï¼ˆObject1ï¼‰ï¼š`image_recognition` å‡½æ•°

#### åŠŸèƒ½ï¼š
`image_recognition` å‡½æ•°è´Ÿè´£ä»ç”¨æˆ·ä¸Šä¼ æˆ–æ‹æ‘„çš„å›¾åƒä¸­è¯†åˆ«é£Ÿæã€‚è¯¥éƒ¨åˆ†ä½¿ç”¨ä½ è‡ªå®šä¹‰è®­ç»ƒçš„æ¨¡å‹ï¼Œé€šè¿‡å›¾åƒåˆ†ç±»æ¥åˆ¤æ–­å›¾åƒä¸­çš„é£Ÿæç±»å‹ï¼Œå¹¶å°†è¯†åˆ«ç»“æœè¿”å›ç»™åç»­æ­¥éª¤ã€‚

#### å®ç°ï¼š
- **è¾“å…¥ï¼š** ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡æˆ–é€šè¿‡æ‘„åƒå¤´æ‹æ‘„çš„å›¾ç‰‡ã€‚
- **è¿‡ç¨‹ï¼š**
  - åŠ è½½å¹¶é¢„å¤„ç†è¾“å…¥å›¾ç‰‡ï¼Œå°†å…¶è°ƒæ•´ä¸ºæ¨¡å‹æ‰€éœ€çš„å¤§å°ï¼ˆå¦‚ 224x224ï¼‰ï¼Œå¹¶è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ã€‚
  - ä½¿ç”¨ CLIP æ¨¡å‹æˆ–è‡ªå®šä¹‰è®­ç»ƒçš„å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰è¿›è¡Œé£Ÿæè¯†åˆ«ï¼Œå°†å›¾ç‰‡è½¬æ¢ä¸ºç‰¹å¾å‘é‡ã€‚
  - å°†ç”Ÿæˆçš„ç‰¹å¾å‘é‡ä¸ä¸€ç»„é¢„å®šä¹‰çš„é£Ÿæç±»åˆ«è¿›è¡ŒåŒ¹é…ï¼Œè¿”å›æœ€å¯èƒ½çš„é£Ÿæåˆ†ç±»ç»“æœã€‚
  
- **è¾“å‡ºï¼š** é¢„æµ‹å‡ºçš„é£Ÿæåˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼šè‹¹æœã€èƒ¡èåœã€ç‰›æ’ç­‰ï¼‰ã€‚

```python
def image_recognition(img):
    image = preprocess(img).unsqueeze(0).to(device)
    text = clip.tokenize([f"a photo of {ingredient}" for ingredient in ingredient_list]).to(device)
    
    with torch.no_grad():
        image_features = model.encode_image(image)
        text_features = model.encode_text(text)
        logits_per_image, _ = model(image, text)
        probs = logits_per_image.softmax(dim=-1).cpu().numpy()
    
    top_k = 3
    top_indices = probs.argsort()[0][-top_k:][::-1]
    predicted_ingredients = [ingredient_list[i] for i in top_indices]
    
    return predicted_ingredients
```

### 2. é£Ÿè°±æ¨èï¼ˆObject2ï¼‰ï¼š`recipe_recommendation` å‡½æ•°

#### åŠŸèƒ½ï¼š
`recipe_recommendation` å‡½æ•°æ ¹æ®è¯†åˆ«å‡ºçš„é£Ÿæç”Ÿæˆä¸ªæ€§åŒ–çš„é£Ÿè°±æ¨èã€‚é€šè¿‡è¾“å…¥é£Ÿæåˆ—è¡¨ï¼Œç³»ç»Ÿä¼šç”Ÿæˆå¯¹åº”çš„é£Ÿè°±ï¼Œå¹¶å±•ç¤ºç»™ç”¨æˆ·ã€‚

#### å®ç°ï¼š
- **è¾“å…¥ï¼š** ç”±é£Ÿæè¯†åˆ«éƒ¨åˆ†è¿”å›çš„é£Ÿæåˆ—è¡¨ï¼ˆå¦‚ï¼šè‹¹æœã€èƒ¡èåœï¼‰ã€‚
- **è¿‡ç¨‹ï¼š**
  - ä½¿ç”¨ GPT-2 ç­‰æ–‡æœ¬ç”Ÿæˆæ¨¡å‹ï¼Œæ ¹æ®å·²è¯†åˆ«çš„é£Ÿæç”Ÿæˆè¯¦ç»†çš„é£Ÿè°±ã€‚æ¯ä¸ªé£Ÿè°±åŒ…å«æ‰€éœ€çš„é£Ÿæã€æ•°é‡å’Œé€æ­¥çš„çƒ¹é¥ªæ–¹æ³•ã€‚
  - æ¨¡å‹æ ¹æ®è¾“å…¥çš„é£Ÿæå’Œé£Ÿè°±æ¨¡æ¿ç”Ÿæˆæ¨èå†…å®¹ã€‚
  
- **è¾“å‡ºï¼š** ç”Ÿæˆçš„é£Ÿè°±æ–‡æœ¬ï¼Œä¾‹å¦‚é£Ÿæçš„å‡†å¤‡æ–¹æ³•ã€æ‰€éœ€æ•°é‡ç­‰ã€‚

```python
def recipe_recommendation(ingredients):
    generator = pipeline('text-generation', model='gpt2-medium')
    
    prompt = f"Create a detailed recipe using {', '.join(ingredients)}:\n1."
    recipe = generator(
        prompt,
        max_length=300,
        num_return_sequences=1,
        temperature=0.7,
        top_p=0.9
    )
    
    return recipe[0]['generated_text']
```

### 3. è¥å…»åˆ†æï¼ˆObject3ï¼‰ï¼š`nutritional_analysis` å‡½æ•°

#### åŠŸèƒ½ï¼š
`nutritional_analysis` å‡½æ•°æ ¹æ®è¯†åˆ«å‡ºçš„é£Ÿæè®¡ç®—æ¯ä¸ªé£Ÿæçš„è¥å…»æˆåˆ†ï¼Œæœ€ç»ˆæ±‡æ€»å‡ºæ•´é“èœçš„è¥å…»ä¿¡æ¯ï¼Œå¦‚çƒ­é‡ã€è„‚è‚ªã€è›‹ç™½è´¨å’Œç¢³æ°´åŒ–åˆç‰©ç­‰ã€‚

#### å®ç°ï¼š
- **è¾“å…¥ï¼š** ç”±é£Ÿæè¯†åˆ«éƒ¨åˆ†è¿”å›çš„é£Ÿæåˆ—è¡¨ã€‚
- **è¿‡ç¨‹ï¼š**
  - é€šè¿‡ `openfoodfacts` API è·å–æ¯ç§é£Ÿæçš„è¥å…»æˆåˆ†æ•°æ®ã€‚
  - æ±‡æ€»å„ä¸ªé£Ÿæçš„è¥å…»æ•°æ®ï¼Œç”Ÿæˆæ¯100å…‹é£Ÿæçš„çƒ­é‡ã€è„‚è‚ªã€è›‹ç™½è´¨å’Œç¢³æ°´åŒ–åˆç‰©å«é‡ã€‚
  - å°†æ‰€æœ‰é£Ÿæçš„è¥å…»æ•°æ®æ±‡æ€»æˆä¸€ä»½æŠ¥å‘Šã€‚
  
- **è¾“å‡ºï¼š** æ¯é“èœçš„è¥å…»åˆ†æç»“æœï¼ˆå¦‚æ€»çƒ­é‡ã€è„‚è‚ªå«é‡ç­‰ï¼‰ã€‚

```python
def nutritional_analysis(ingredients):
    total = {"energy": 0, "fat": 0, "carbohydrates": 0, "protein": 0}
    
    for ingredient in ingredients:
        if ingredient.lower() in nutrition_db:
            data = nutrition_db[ingredient.lower()]
            total["energy"] += data["energy"]
            total["fat"] += data["fat"]
            total["carbohydrates"] += data["carbohydrates"]
            total["protein"] += data["protein"]
    
    return total
```

### 4. ä¸²è”æµç¨‹ï¼šç”¨æˆ·äº¤äº’å’Œæ•´ä½“æ¶æ„

#### åŠŸèƒ½ï¼š
æ•´ä¸ªåº”ç”¨é€šè¿‡**æµå¼æ•°æ®ä¼ é€’**å°†è¿™ä¸‰ä¸ªæ¨¡å—ä¸²è”åœ¨ä¸€èµ·ã€‚ç”¨æˆ·ä¸Šä¼ ä¸€å¼ åŒ…å«é£Ÿæçš„å›¾ç‰‡åï¼Œç³»ç»Ÿä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

1. **é£Ÿæè¯†åˆ«ï¼š**
   - ç”¨æˆ·ä¸Šä¼ å›¾åƒåï¼Œè°ƒç”¨ `image_recognition` å‡½æ•°å¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œè¯†åˆ«å‡ºå›¾åƒä¸­çš„é£Ÿæã€‚
   - ä¾‹å¦‚ï¼Œå¦‚æœå›¾åƒä¸­åŒ…å«è‹¹æœå’Œèƒ¡èåœï¼Œç³»ç»Ÿä¼šè¿”å› `["apple", "carrot"]`ã€‚
  
2. **é£Ÿè°±æ¨èï¼š**
   - å°†è¯†åˆ«å‡ºçš„é£Ÿæåˆ—è¡¨ä¼ é€’ç»™ `recipe_recommendation` å‡½æ•°ï¼Œç³»ç»Ÿç”Ÿæˆä¸ªæ€§åŒ–çš„é£Ÿè°±æ¨èã€‚
   - ä¾‹å¦‚ï¼Œå¦‚æœæ£€æµ‹åˆ°è‹¹æœå’Œèƒ¡èåœï¼Œç³»ç»Ÿå¯èƒ½ä¼šç”Ÿæˆâ€œèƒ¡èåœè‹¹æœæ²™æ‹‰â€ä¹‹ç±»çš„é£Ÿè°±ã€‚

3. **è¥å…»åˆ†æï¼š**
   - å°†è¯†åˆ«å‡ºçš„é£Ÿæåˆ—è¡¨ä¼ é€’ç»™ `nutritional_analysis` å‡½æ•°ï¼Œè®¡ç®—æ¯ç§é£Ÿæçš„è¥å…»æˆåˆ†ï¼Œå¹¶æ±‡æ€»å‡ºæ•´é“èœçš„è¥å…»åˆ†ææŠ¥å‘Šã€‚
   - ä¾‹å¦‚ï¼Œè®¡ç®—è‹¹æœå’Œèƒ¡èåœçš„æ€»çƒ­é‡ã€è„‚è‚ªã€è›‹ç™½è´¨å’Œç¢³æ°´åŒ–åˆç‰©å«é‡ã€‚

4. **å¯è§†åŒ–ç»“æœï¼š**
   - æœ€åï¼Œæ‰€æœ‰çš„ç»“æœï¼ˆé£Ÿæè¯†åˆ«ã€é£Ÿè°±æ¨èå’Œè¥å…»åˆ†æï¼‰éƒ½ä¼šé€šè¿‡ç”¨æˆ·ç•Œé¢å‘ˆç°ç»™ç”¨æˆ·ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°å›¾ç‰‡ã€é¢„æµ‹çš„é£Ÿæã€é£Ÿè°±æ¨èä»¥åŠè¥å…»åˆ†æã€‚

#### ä¸»ç¨‹åºï¼šæ•´åˆå„ä¸ªæ¨¡å—

åœ¨ä¸»ç¨‹åºä¸­ï¼Œè¿™ä¸‰ä¸ªå¯¹è±¡è¢«è°ƒç”¨å¹¶ç»„åˆèµ·æ¥å½¢æˆä¸€ä¸ªå®Œæ•´çš„å·¥ä½œæµï¼š

```python
def main():
    st.title("ğŸ³ Smart Recipe Recommendation System")
    st.write("Upload an image of ingredients to get recipe suggestions and nutritional analysis")
    
    # ä¸Šä¼ å›¾ç‰‡
    uploaded_file = st.file_uploader("Choose an image...", type=["jpg", "png", "jpeg"])
    if uploaded_file:
        img = Image.open(uploaded_file)
        st.image(img, caption='ğŸ“¸ Uploaded Image', use_column_width=True)
        
        # æ‰§è¡Œå›¾åƒè¯†åˆ«
        detected_ingredients = image_recognition(img)
        
        # æ˜¾ç¤ºæ£€æµ‹åˆ°çš„é£Ÿæ
        st.subheader("ğŸ” Detected Ingredients")
        st.write(detected_ingredients)
        
        # é£Ÿè°±æ¨è
        st.subheader("ğŸ½ï¸ Recommended Recipes")
        recipe = recipe_recommendation(detected_ingredients)
        st.write(recipe)
        
        # è¥å…»åˆ†æ
        st.subheader("ğŸ“Š Nutritional Analysis")
        nutrition = nutritional_analysis(detected_ingredients)
        st.write(nutrition)
```

#### æ€»ç»“

è¿™ä¸ªåº”ç”¨ç¨‹åºé€šè¿‡ä»¥ä¸‹æ–¹å¼ä¸²è”äº†ä¸‰ä¸ªä¸»è¦å¯¹è±¡ï¼š

1. **å›¾åƒè¯†åˆ«ï¼ˆObject1ï¼‰**ï¼šè¯†åˆ«å›¾åƒä¸­çš„é£Ÿæå¹¶è¿”å›é£Ÿæåˆ—è¡¨ã€‚
2. **é£Ÿè°±æ¨èï¼ˆObject2ï¼‰**ï¼šæ ¹æ®è¯†åˆ«å‡ºçš„é£Ÿæç”Ÿæˆä¸ªæ€§åŒ–çš„é£Ÿè°±æ¨èã€‚
3. **è¥å…»åˆ†æï¼ˆObject3ï¼‰**ï¼šè®¡ç®—è¯†åˆ«é£Ÿæçš„è¥å…»æˆåˆ†å¹¶ç”Ÿæˆè¥å…»æŠ¥å‘Šã€‚

é€šè¿‡è¿™ç§ä¸²è”ï¼Œæ•´ä¸ªåº”ç”¨ç³»ç»Ÿèƒ½å¤Ÿä»ç”¨æˆ·ä¸Šä¼ å›¾åƒåˆ°æœ€ç»ˆæä¾›é£Ÿè°±å»ºè®®å’Œè¥å…»åˆ†æï¼Œå®Œæˆä¸€ä¸ªå®Œæ•´çš„é£Ÿæè¯†åˆ«ä¸æ¨èæµç¨‹ã€‚
